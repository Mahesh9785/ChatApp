<meta name="viewport" content="width=device-width, initial-scale=1">
<div id="container">
  <aside>
    <header>
      <div class="title"> My Chats </div>
    </header>
      <ul>
      <li *ngFor="let user of USERS" (click)="selectUserHandler(user.email)" #item>
        <img class="img-size" src="./assets/p5.webp" alt="" />
        <div>
          <h2>{{ user.name }}</h2>
          <h3>
            <span class="status orange"></span>
          </h3>
        </div>
      </li>
    </ul>

  </aside>
  <main>
    <ng-container *ngIf="selectedUser">
      <header>
        <img class="img-size" src="./assets/p5.webp" alt="" />
        <div>
          <h2>{{ selectedUser.name }}</h2>
          <!-- <h3>already 1902 messages</h3> -->
          <!-- <h3>already {{count}} messages</h3> -->

        </div>
        <!-- <img
          src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/1940306/ico_star.png"
          alt=""
        /> -->
      </header>
      <main>
        <div class="chat" #messageListRef class="message-list" [scrollTop]="messageListRef.scrollHeight">         
          <ul id="chat">
            <!-- [ngClass]="item?.email === currentUser?.email?  'same-user' : 'you'" -->
            <div *ngFor="let msg of messages">
              <li
                [ngClass]="{
                  you: msg.sender === selectedUser.email,
                  me: msg.sender === currentUser.email
                }"
              >
                <div class="entete">
                  <span class="status green"></span>
                  <h2 *ngIf="msg.sender === selectedUser.email; else elseblock">
                    {{ selectedUser.name }}
                  </h2>
                  <ng-template #elseblock>
                    <h2>{{ currentUser.name }}</h2>
                  </ng-template>
                  <h3>{{ msg.timestamp | date : "shortTime" }}</h3>
                </div>
                <div class="triangle"></div>
                <div class="message">{{ msg.message }}</div>
              </li>
            </div>
          </ul>
        </div>
        <footer>
          <div class="footer-btn text-center">
            <form (submit)="sendMessage(message)">
              <button class="btn">Send</button>
              <textarea
                placeholder="Type your message"
                id="inputMessage"
                name="messageInput"
                [(ngModel)]="message"
                (keyup.enter)="sendMessage(message)"
              ></textarea>
            </form>
          </div>
        </footer>
        <!-- </ng-container> -->
      </main>
    </ng-container>
  </main>
</div>
